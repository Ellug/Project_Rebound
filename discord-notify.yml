name: Discord Notification

on:
  pull_request:
    types: [opened, closed] # PRì´ ì—´ë¦¬ê±°ë‚˜ ë‹«í ë•Œë§Œ íŠ¸ë¦¬ê±°

jobs:
  discord-notify:
    runs-on: ubuntu-latest
    steps:
      # 1. PRì´ ìƒì„±(Open)ë˜ì—ˆì„ ë•Œ ì‹¤í–‰
      - name: Notify PR Opened
        if: github.event.action == 'opened'
        env:
          DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
        run: |
          curl -H "Content-Type: application/json" \
          -d '{
            "username": "GitHub Actions",
            "content": "ğŸ“¢ **ìƒˆë¡œìš´ PRì´ ë„ì°©í–ˆìŠµë‹ˆë‹¤!**",
            "embeds": [{
              "title": "${{ github.event.pull_request.title }}",
              "url": "${{ github.event.pull_request.html_url }}",
              "description": "ìš”ì²­ì: ${{ github.actor }}",
              "color": 3447003
            }]
          }' $DISCORD_WEBHOOK

      # 2. PRì´ ë³‘í•©(Merged)ë˜ì—ˆì„ ë•Œ ì‹¤í–‰
      # (closed ìƒíƒœì´ë©´ì„œ mergedê°€ trueì¸ ê²½ìš°)
      - name: Notify PR Merged
        if: github.event.action == 'closed' && github.event.pull_request.merged == true
        env:
          DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
        run: |
          curl -H "Content-Type: application/json" \
          -d '{
            "username": "GitHub Actions",
            "content": "âœ… **PRì´ ë³‘í•©ë˜ì—ˆìŠµë‹ˆë‹¤!**",
            "embeds": [{
              "title": "${{ github.event.pull_request.title }}",
              "url": "${{ github.event.pull_request.html_url }}",
              "description": "ë³‘í•©ëœ ë¸Œëœì¹˜: ${{ github.base_ref }}",
              "color": 3066993
            }]
          }' $DISCORD_WEBHOOK

      # (ì„ íƒì‚¬í•­) 3. PRì´ ë³‘í•©ë˜ì§€ ì•Šê³  ë‹«í˜”ì„ ë•Œ (ê±°ì ˆ/ì·¨ì†Œ)
      - name: Notify PR Closed (Not Merged)
        if: github.event.action == 'closed' && github.event.pull_request.merged == false
        env:
          DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
        run: |
          curl -H "Content-Type: application/json" \
          -d '{
            "username": "GitHub Actions",
            "content": "ğŸš« **PRì´ ë‹«í˜”ìŠµë‹ˆë‹¤ (ë³‘í•© ê±°ì ˆ or ì·¨ì†Œ).**",
            "embeds": [{
              "title": "${{ github.event.pull_request.title }}",
              "color": 15158332
            }]
          }' $DISCORD_WEBHOOK